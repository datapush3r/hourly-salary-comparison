<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Australian Salary Comparison Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
        }
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom CSS for the toggle switch's ::before pseudo-element */
        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider:before {
            transform: translateX(20px);
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-black text-gray-800 dark:text-gray-300 transition-colors duration-300">

    <div class="container mx-auto px-4 py-8 md:py-12">
        <div class="max-w-5xl mx-auto relative">
             <!-- Theme Switcher -->
            <div class="absolute top-0 right-0">
                <button id="theme-toggle" type="button" class="text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 focus:outline-none focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 rounded-lg text-sm p-2.5">
                    <svg id="theme-toggle-dark-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg>
                    <svg id="theme-toggle-light-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.707.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm-.707 10.607a1 1 0 011.414 0l.707-.707a1 1 0 111.414 1.414l-.707-.707a1 1 0 01-1.414 0zM4 11a1 1 0 100-2H3a1 1 0 100 2h1z" fill-rule="evenodd" clip-rule="evenodd"></path></svg>
                </button>
            </div>
            <!-- Header -->
            <header class="text-center mb-10">
                <h1 class="text-3xl md:text-4xl font-bold text-gray-900 dark:text-white">Australian Salary Comparison Calculator</h1>
                <p class="mt-2 text-lg text-gray-600 dark:text-gray-400">Compare a contract rate vs. a full-time salary package side-by-side.</p>
            </header>

            <main>
                <!-- Shared Inputs & Adjustments -->
                <div class="bg-white dark:bg-black dark:border dark:border-gray-800 p-6 md:p-8 rounded-2xl shadow-lg mb-8">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-10 gap-y-8">
                        <div>
                           <h2 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-4 text-center">Work Schedule</h2>
                            <div class="grid grid-cols-2 gap-6">
                                <div>
                                    <label for="hoursPerWeek" class="block text-sm font-medium text-gray-700 dark:text-gray-400 mb-1">Hours per Week</label>
                                    <input type="number" id="hoursPerWeek" value="38" class="w-full px-4 py-3 bg-gray-100 dark:bg-black dark:border dark:border-gray-700 dark:text-gray-100 rounded-lg text-lg transition duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 dark:focus:ring-gray-600 dark:focus:ring-offset-black">
                                </div>
                                <div>
                                    <label for="daysPerWeek" class="block text-sm font-medium text-gray-700 dark:text-gray-400 mb-1">Days per Week</label>
                                    <input type="number" id="daysPerWeek" value="5" class="w-full px-4 py-3 bg-gray-100 dark:bg-black dark:border dark:border-gray-700 dark:text-gray-100 rounded-lg text-lg transition duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 dark:focus:ring-gray-600 dark:focus:ring-offset-black">
                                </div>
                            </div>
                        </div>
                        <div>
                             <h2 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-4 text-center">Comparison Adjustments</h2>
                             <div class="space-y-4">
                                <div class="flex items-center justify-between">
                                    <label for="stateSelect" class="text-sm font-medium text-gray-700 dark:text-gray-400">State/Territory (for holidays)</label>
                                    <select id="stateSelect" class="rounded-lg bg-gray-100 dark:bg-black dark:border dark:border-gray-700 dark:text-gray-100 text-sm py-1 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 dark:focus:ring-gray-600 dark:focus:ring-offset-black">
                                        <option value="NSW">NSW</option>
                                        <option value="VIC">VIC</option>
                                        <option value="QLD">QLD</option>
                                        <option value="WA">WA</option>
                                        <option value="SA">SA</option>
                                        <option value="TAS">TAS</option>
                                        <option value="ACT">ACT</option>
                                        <option value="NT">NT</option>
                                    </select>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-sm font-medium text-gray-700 dark:text-gray-400">Account for unpaid leave? <span class="text-xs">(Contractor)</span></span>
                                    <label class="relative inline-block w-[44px] h-[24px]">
                                        <input type="checkbox" id="unpaidLeaveToggle" class="opacity-0 w-0 h-0 peer">
                                        <span class="slider absolute cursor-pointer top-0 left-0 right-0 bottom-0 bg-gray-300 dark:bg-gray-800 peer-checked:bg-green-600 transition rounded-full"></span>
                                    </label>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-sm font-medium text-gray-700 dark:text-gray-400">Have HECS/HELP debt?</span>
                                    <label class="relative inline-block w-[44px] h-[24px]">
                                        <input type="checkbox" id="hecsToggle" class="opacity-0 w-0 h-0 peer">
                                        <span class="slider absolute cursor-pointer top-0 left-0 right-0 bottom-0 bg-gray-300 dark:bg-gray-800 peer-checked:bg-green-600 transition rounded-full"></span>
                                    </label>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-sm font-medium text-gray-700 dark:text-gray-400">High income, no private health? <span class="text-xs">(MLS)</span></span>
                                    <label class="relative inline-block w-[44px] h-[24px]">
                                        <input type="checkbox" id="mlsToggle" class="opacity-0 w-0 h-0 peer">
                                        <span class="slider absolute cursor-pointer top-0 left-0 right-0 bottom-0 bg-gray-300 dark:bg-gray-800 peer-checked:bg-green-600 transition rounded-full"></span>
                                    </label>
                                </div>
                             </div>
                        </div>
                    </div>
                </div>

                <!-- Comparison Columns -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    
                    <!-- Contract Column -->
                    <div class="bg-white dark:bg-black dark:border dark:border-gray-800 p-6 rounded-2xl shadow-lg">
                        <h2 class="text-2xl font-bold text-center text-gray-900 dark:text-white mb-6">Contract Role</h2>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6">
                             <div>
                                <label for="hourlyRate" class="block text-sm font-medium text-gray-700 dark:text-gray-400 mb-1">Hourly Rate ($)</label>
                                <input type="number" id="hourlyRate" placeholder="e.g., 80" class="w-full px-3 py-2 bg-gray-100 dark:bg-black dark:border dark:border-gray-700 dark:text-gray-100 dark:placeholder-gray-500 rounded-lg text-base focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 dark:focus:ring-gray-600 dark:focus:ring-offset-black">
                            </div>
                            <div>
                                <label for="dailyRate" class="block text-sm font-medium text-gray-700 dark:text-gray-400 mb-1">Daily Rate ($)</label>
                                <input type="number" id="dailyRate" placeholder="e.g., 640" class="w-full px-3 py-2 bg-gray-100 dark:bg-black dark:border dark:border-gray-700 dark:text-gray-100 dark:placeholder-gray-500 rounded-lg text-base focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 dark:focus:ring-gray-600 dark:focus:ring-offset-black">
                            </div>
                        </div>
                        <div class="space-y-3">
                            <div class="bg-white dark:bg-black dark:border dark:border-gray-800 p-5 rounded-xl shadow-md flex justify-between items-center transition-all duration-300">
                                <p id="grossBillingsLabel" class="font-medium text-gray-600 dark:text-gray-400">Gross Yearly Billings</p>
                                <p id="contractYearlySalary" class="text-xl font-semibold text-gray-900 dark:text-white">$0.00</p>
                            </div>
                            <div class="bg-white dark:bg-black dark:border dark:border-gray-800 p-5 rounded-xl shadow-md flex justify-between items-center transition-all duration-300">
                                <p class="font-medium text-red-600 dark:text-red-500">Superannuation <span class="text-xs">(to pay)</span></p>
                                <p id="contractSuper" class="text-lg font-semibold text-red-700 dark:text-red-500">-$0.00</p>
                            </div>
                            <div class="bg-white dark:bg-black dark:border dark:border-gray-800 p-5 rounded-xl shadow-md flex justify-between items-center transition-all duration-300">
                                <p class="font-medium text-red-600 dark:text-red-500">Yearly Tax <span id="contractTaxLabel" class="text-xs">(est.)</span></p>
                                <p id="contractIncomeTax" class="text-lg font-semibold text-red-700 dark:text-red-500">-$0.00</p>
                            </div>
                            <hr class="!my-4 border-gray-200 dark:border-gray-700">
                            <div class="bg-green-600 text-white p-5 rounded-xl shadow-md flex justify-between items-center">
                                <p class="font-bold">Take-Home Pay (Yearly)</p>
                                <p id="contractPostTaxYearly" class="text-xl font-bold">$0.00</p>
                            </div>
                            <div class="mt-4 space-y-2">
                                <div class="bg-gray-100 dark:bg-black dark:border dark:border-gray-800 p-3 rounded-lg flex justify-between items-center text-sm"> <p class="font-medium text-gray-600 dark:text-gray-400">Hourly</p> <p id="contractPostTaxHourly" class="font-semibold text-gray-800 dark:text-gray-100">$0.00</p> </div>
                                <div class="bg-gray-100 dark:bg-black dark:border dark:border-gray-800 p-3 rounded-lg flex justify-between items-center text-sm"> <p class="font-medium text-gray-600 dark:text-gray-400">Daily</p> <p id="contractPostTaxDaily" class="font-semibold text-gray-800 dark:text-gray-100">$0.00</p> </div>
                                <div class="bg-gray-100 dark:bg-black dark:border dark:border-gray-800 p-3 rounded-lg flex justify-between items-center text-sm"> <p class="font-medium text-gray-600 dark:text-gray-400">Weekly</p> <p id="contractPostTaxWeekly" class="font-semibold text-gray-800 dark:text-gray-100">$0.00</p> </div>
                                <div class="bg-gray-100 dark:bg-black dark:border dark:border-gray-800 p-3 rounded-lg flex justify-between items-center text-sm"> <p class="font-medium text-gray-600 dark:text-gray-400">Fortnightly</p> <p id="contractPostTaxFortnightly" class="font-semibold text-gray-800 dark:text-gray-100">$0.00</p> </div>
                                <div class="bg-gray-100 dark:bg-black dark:border dark:border-gray-800 p-3 rounded-lg flex justify-between items-center text-sm"> <p class="font-medium text-gray-600 dark:text-gray-400">Monthly</p> <p id="contractPostTaxMonthly" class="font-semibold text-gray-800 dark:text-gray-100">$0.00</p> </div>
                                <div class="bg-gray-100 dark:bg-black dark:border dark:border-gray-800 p-3 rounded-lg flex justify-between items-center text-sm"> <p class="font-medium text-gray-600 dark:text-gray-400">Quarterly</p> <p id="contractPostTaxQuarterly" class="font-semibold text-gray-800 dark:text-gray-100">$0.00</p> </div>
                            </div>
                        </div>
                    </div>

                    <!-- Full-time Column -->
                    <div class="bg-white dark:bg-black dark:border dark:border-gray-800 p-6 rounded-2xl shadow-lg">
                        <h2 class="text-2xl font-bold text-center text-gray-900 dark:text-white mb-6">Full-time Role</h2>
                        <div class="mb-6">
                            <label for="annualSalaryInput" class="block text-sm font-medium text-gray-700 dark:text-gray-400 mb-1">Annual Salary (pre-tax)</label>
                            <input type="number" id="annualSalaryInput" placeholder="e.g., 130000" class="w-full px-3 py-2 bg-gray-100 dark:bg-black dark:border dark:border-gray-700 dark:text-gray-100 dark:placeholder-gray-500 rounded-lg text-base focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 dark:focus:ring-gray-600 dark:focus:ring-offset-black">
                        </div>
                         <div class="space-y-3">
                            <div class="bg-white dark:bg-black dark:border dark:border-gray-800 p-5 rounded-xl shadow-md flex justify-between items-center transition-all duration-300">
                                <p class="font-medium text-gray-600 dark:text-gray-400">Yearly Salary <span class="text-xs">(pre-tax)</span></p>
                                <p id="fullTimeYearlySalary" class="text-xl font-semibold text-gray-900 dark:text-white">$0.00</p>
                            </div>
                            <div class="bg-white dark:bg-black dark:border dark:border-gray-800 p-5 rounded-xl shadow-md flex justify-between items-center transition-all duration-300">
                                <p class="font-medium text-gray-600 dark:text-gray-400">Superannuation</p>
                                <p id="fullTimeSuper" class="text-lg font-semibold text-gray-800 dark:text-gray-100">$0.00</p>
                            </div>
                            <div class="bg-white dark:bg-black dark:border dark:border-gray-800 p-5 rounded-xl shadow-md flex justify-between items-center transition-all duration-300">
                                <p class="font-medium text-red-600 dark:text-red-500">Yearly Tax <span id="fullTimeTaxLabel" class="text-xs">(est.)</span></p>
                                <p id="fullTimeIncomeTax" class="text-lg font-semibold text-red-700 dark:text-red-500">-$0.00</p>
                            </div>
                             <hr class="!my-4 border-gray-200 dark:border-gray-700">
                            <div class="bg-green-600 text-white p-5 rounded-xl shadow-md flex justify-between items-center">
                                <p class="font-bold">Take-Home Pay (Yearly)</p>
                                <p id="fullTimePostTaxYearly" class="text-xl font-bold">$0.00</p>
                            </div>
                            <div class="mt-4 space-y-2">
                                <div class="bg-gray-100 dark:bg-black dark:border dark:border-gray-800 p-3 rounded-lg flex justify-between items-center text-sm"> <p class="font-medium text-gray-600 dark:text-gray-400">Hourly</p> <p id="fullTimePostTaxHourly" class="font-semibold text-gray-800 dark:text-gray-100">$0.00</p> </div>
                                <div class="bg-gray-100 dark:bg-black dark:border dark:border-gray-800 p-3 rounded-lg flex justify-between items-center text-sm"> <p class="font-medium text-gray-600 dark:text-gray-400">Daily</p> <p id="fullTimePostTaxDaily" class="font-semibold text-gray-800 dark:text-gray-100">$0.00</p> </div>
                                <div class="bg-gray-100 dark:bg-black dark:border dark:border-gray-800 p-3 rounded-lg flex justify-between items-center text-sm"> <p class="font-medium text-gray-600 dark:text-gray-400">Weekly</p> <p id="fullTimePostTaxWeekly" class="font-semibold text-gray-800 dark:text-gray-100">$0.00</p> </div>
                                <div class="bg-gray-100 dark:bg-black dark:border dark:border-gray-800 p-3 rounded-lg flex justify-between items-center text-sm"> <p class="font-medium text-gray-600 dark:text-gray-400">Fortnightly</p> <p id="fullTimePostTaxFortnightly" class="font-semibold text-gray-800 dark:text-gray-100">$0.00</p> </div>
                                <div class="bg-gray-100 dark:bg-black dark:border dark:border-gray-800 p-3 rounded-lg flex justify-between items-center text-sm"> <p class="font-medium text-gray-600 dark:text-gray-400">Monthly</p> <p id="fullTimePostTaxMonthly" class="font-semibold text-gray-800 dark:text-gray-100">$0.00</p> </div>
                                <div class="bg-gray-100 dark:bg-black dark:border dark:border-gray-800 p-3 rounded-lg flex justify-between items-center text-sm"> <p class="font-medium text-gray-600 dark:text-gray-400">Quarterly</p> <p id="fullTimePostTaxQuarterly" class="font-semibold text-gray-800 dark:text-gray-100">$0.00</p> </div>
                            </div>
                        </div>
                    </div>

                </div>
                
                <!-- Difference Comparison Section -->
                <div class="mt-8 bg-white dark:bg-black dark:border dark:border-gray-800 p-6 rounded-2xl shadow-lg text-center">
                    <h3 class="text-xl font-bold text-gray-800 dark:text-gray-200 mb-2">Take-Home Pay Difference</h3>
                    <p id="differenceText" class="text-2xl font-bold text-gray-700 dark:text-gray-200">Enter values to compare</p>
                </div>

                <div class="text-center mt-8">
                    <p id="superNote" class="text-sm text-gray-500 dark:text-gray-500 max-w-3xl mx-auto"></p>
                </div>
            </main>
        </div>
    </div>

    <script>
        // --- DOM Elements ---
        const themeToggleBtn = document.getElementById('theme-toggle');
        const themeToggleDarkIcon = document.getElementById('theme-toggle-dark-icon');
        const themeToggleLightIcon = document.getElementById('theme-toggle-light-icon');
        const hoursPerWeekInput = document.getElementById('hoursPerWeek');
        const daysPerWeekInput = document.getElementById('daysPerWeek');
        const superNoteEl = document.getElementById('superNote');
        const unpaidLeaveToggle = document.getElementById('unpaidLeaveToggle');
        const hecsToggle = document.getElementById('hecsToggle');
        const mlsToggle = document.getElementById('mlsToggle');
        const stateSelect = document.getElementById('stateSelect');
        const grossBillingsLabel = document.getElementById('grossBillingsLabel');
        const contractTaxLabel = document.getElementById('contractTaxLabel');
        const fullTimeTaxLabel = document.getElementById('fullTimeTaxLabel');

        // Contract Elements
        const hourlyRateInput = document.getElementById('hourlyRate');
        const dailyRateInput = document.getElementById('dailyRate');
        const contractYearlySalaryEl = document.getElementById('contractYearlySalary');
        const contractIncomeTaxEl = document.getElementById('contractIncomeTax');
        const contractPostTaxYearlyEl = document.getElementById('contractPostTaxYearly');
        const contractSuperEl = document.getElementById('contractSuper');
        const contractPostTaxHourlyEl = document.getElementById('contractPostTaxHourly');
        const contractPostTaxDailyEl = document.getElementById('contractPostTaxDaily');
        const contractPostTaxWeeklyEl = document.getElementById('contractPostTaxWeekly');
        const contractPostTaxFortnightlyEl = document.getElementById('contractPostTaxFortnightly');
        const contractPostTaxMonthlyEl = document.getElementById('contractPostTaxMonthly');
        const contractPostTaxQuarterlyEl = document.getElementById('contractPostTaxQuarterly');

        // Full-time Elements
        const annualSalaryInput = document.getElementById('annualSalaryInput');
        const fullTimeYearlySalaryEl = document.getElementById('fullTimeYearlySalary');
        const fullTimeIncomeTaxEl = document.getElementById('fullTimeIncomeTax');
        const fullTimePostTaxYearlyEl = document.getElementById('fullTimePostTaxYearly');
        const fullTimeSuperEl = document.getElementById('fullTimeSuper');
        const fullTimePostTaxHourlyEl = document.getElementById('fullTimePostTaxHourly');
        const fullTimePostTaxDailyEl = document.getElementById('fullTimePostTaxDaily');
        const fullTimePostTaxWeeklyEl = document.getElementById('fullTimePostTaxWeekly');
        const fullTimePostTaxFortnightlyEl = document.getElementById('fullTimePostTaxFortnightly');
        const fullTimePostTaxMonthlyEl = document.getElementById('fullTimePostTaxMonthly');
        const fullTimePostTaxQuarterlyEl = document.getElementById('fullTimePostTaxQuarterly');
        
        // Comparison Element
        const differenceTextEl = document.getElementById('differenceText');

        // --- State ---
        let lastChangedRate = 'hourly';
        let contractTakeHomeYearly = 0;
        let fullTimeTakeHomeYearly = 0;

        // --- Constants & Public Data ---
        const SUPER_RATE = 0.12; 
        const WEEKS_PER_YEAR_DEFAULT = 52;
        const WEEKS_PER_YEAR_WITH_LEAVE = 46; // 52 - 4 weeks annual - 2 weeks sick
        const PUBLIC_HOLIDAYS = { // Approx. values
            'NSW': 11, 'VIC': 13, 'QLD': 11, 'WA': 11,
            'SA': 11, 'TAS': 12, 'ACT': 13, 'NT': 11
        };
        const HECS_HELP_RATES = [ // 2024-25 repayment rates
            { threshold: 144503, rate: 0.10 }, { threshold: 136324, rate: 0.095 },
            { threshold: 128617, rate: 0.09 }, { threshold: 121360, rate: 0.085 },
            { threshold: 114532, rate: 0.08 }, { threshold: 108112, rate: 0.075 },
            { threshold: 102074, rate: 0.07 }, { threshold: 96395, rate: 0.065 },
            { threshold: 91052, rate: 0.06 }, { threshold: 86025, rate: 0.055 },
            { threshold: 81297, rate: 0.05 }, { threshold: 76851, rate: 0.045 },
            { threshold: 72671, rate: 0.04 }, { threshold: 68742, rate: 0.035 },
            { threshold: 65050, rate: 0.03 }, { threshold: 61578, rate: 0.025 },
            { threshold: 58309, rate: 0.02 }, { threshold: 55225, rate: 0.015 },
            { threshold: 51550, rate: 0.01 },
        ];
        
        // --- Theme Switch ---
        function applyTheme(theme) {
            if (theme === 'dark') {
                document.documentElement.classList.add('dark');
                themeToggleDarkIcon.classList.remove('hidden');
                themeToggleLightIcon.classList.add('hidden');
                localStorage.setItem('theme', 'dark');
            } else {
                document.documentElement.classList.remove('dark');
                themeToggleLightIcon.classList.remove('hidden');
                themeToggleDarkIcon.classList.add('hidden');
                localStorage.setItem('theme', 'light');
            }
        }

        // --- Utility Functions ---
        const formatCurrency = (value, showNegative = false) => {
            const num = isNaN(value) || !isFinite(value) ? 0 : value;
            const sign = showNegative ? '-' : '';
            return sign + num.toLocaleString('en-AU', { style: 'currency', currency: 'AUD', minimumFractionDigits: 2, maximumFractionDigits: 2 });
        };
        
        // --- Tax Calculation (2024-2025 rates) ---
        function calculateTax(income, options = {}) {
            const { hasHECS = false, hasMLS = false } = options;
            const MEDICARE_LEVY_RATE = 0.02;
            let totalTax = 0;
            let taxLabelAddons = [];

            // Income Tax
            let incomeTax = 0;
            if (income > 190000) incomeTax = 52442 + (income - 190000) * 0.45;
            else if (income > 135000) incomeTax = 32092 + (income - 135000) * 0.37;
            else if (income > 45000) incomeTax = 5092 + (income - 45000) * 0.30;
            else if (income > 18200) incomeTax = (income - 18200) * 0.19;
            totalTax += incomeTax;

            // Medicare Levy
            totalTax += income * MEDICARE_LEVY_RATE;

            // HECS/HELP Repayment
            if (hasHECS) {
                const hecsTier = HECS_HELP_RATES.find(tier => income >= tier.threshold);
                if (hecsTier) {
                    totalTax += income * hecsTier.rate;
                    taxLabelAddons.push('HECS');
                }
            }

            // Medicare Levy Surcharge
            if (hasMLS) {
                let mlsRate = 0;
                if (income > 151000) mlsRate = 0.015;
                else if (income > 113000) mlsRate = 0.0125;
                else if (income > 97000) mlsRate = 0.01;
                if (mlsRate > 0) {
                    totalTax += income * mlsRate;
                    taxLabelAddons.push('MLS');
                }
            }
            
            const taxLabel = `(est. ${taxLabelAddons.length > 0 ? `inc. ${taxLabelAddons.join('/')}` : ''})`;
            return { totalTax, taxLabel };
        }

        // --- Comparison Function ---
        function updateDifference() {
            if (contractTakeHomeYearly <= 0 && fullTimeTakeHomeYearly <= 0) {
                differenceTextEl.textContent = 'Enter values to compare';
                differenceTextEl.className = 'text-2xl font-bold text-gray-700 dark:text-gray-300';
                return;
            }
            const difference = contractTakeHomeYearly - fullTimeTakeHomeYearly;
            if (difference > 0.01) {
                differenceTextEl.textContent = `${formatCurrency(Math.abs(difference))} / year more as a Contractor`;
                differenceTextEl.className = 'text-2xl font-bold text-green-700 dark:text-green-500';
            } else if (difference < -0.01) {
                differenceTextEl.textContent = `${formatCurrency(Math.abs(difference))} / year more as a Full-time Employee`;
                differenceTextEl.className = 'text-2xl font-bold text-indigo-700 dark:text-white';
            } else {
                differenceTextEl.textContent = 'The take-home pay is effectively identical.';
                differenceTextEl.className = 'text-2xl font-bold text-gray-800 dark:text-white';
            }
        }

        // --- Main Calculation Functions ---
        function calculateContract() {
            const hoursPerWeek = parseFloat(hoursPerWeekInput.value) || 0;
            const daysPerWeek = parseFloat(daysPerWeekInput.value) || 0;
            const hourlyRate = parseFloat(hourlyRateInput.value) || 0;
            const dailyRateVal = parseFloat(dailyRateInput.value) || 0;

            const weeksToWork = unpaidLeaveToggle.checked ? WEEKS_PER_YEAR_WITH_LEAVE : WEEKS_PER_YEAR_DEFAULT;
            const holidays = PUBLIC_HOLIDAYS[stateSelect.value] || 0;
            
            grossBillingsLabel.textContent = unpaidLeaveToggle.checked ? 'Gross Yearly Billings (Adjusted)' : 'Gross Yearly Billings';

            let totalPackage = 0;
            if (daysPerWeek > 0) {
                // Prioritize daily rate for accuracy with leave/holidays
                const effectiveDailyRate = lastChangedRate === 'daily' ? dailyRateVal : hourlyRate * (hoursPerWeek / daysPerWeek);
                const billableDays = (daysPerWeek * weeksToWork) - holidays;
                totalPackage = effectiveDailyRate * billableDays;
            }

            const taxableIncome = totalPackage / (1 + SUPER_RATE);
            const superannuation = totalPackage - taxableIncome;

            const taxOptions = { hasHECS: hecsToggle.checked, hasMLS: mlsToggle.checked };
            const { totalTax, taxLabel } = calculateTax(taxableIncome, taxOptions);
            const postTaxYearly = taxableIncome - totalTax;

            contractTakeHomeYearly = postTaxYearly;

            const workingWeeksForBreakdown = unpaidLeaveToggle.checked ? WEEKS_PER_YEAR_WITH_LEAVE : WEEKS_PER_YEAR_DEFAULT;
            const postTaxWeekly = workingWeeksForBreakdown > 0 ? postTaxYearly / workingWeeksForBreakdown : 0;
            const postTaxDaily = daysPerWeek > 0 ? postTaxWeekly / daysPerWeek : 0;
            const postTaxHourly = hoursPerWeek > 0 ? postTaxWeekly / hoursPerWeek : 0;
            
            // Update main display
            contractYearlySalaryEl.textContent = formatCurrency(totalPackage);
            contractTaxLabel.textContent = taxLabel;
            contractIncomeTaxEl.textContent = formatCurrency(totalTax, true);
            contractPostTaxYearlyEl.textContent = formatCurrency(postTaxYearly);
            contractSuperEl.textContent = formatCurrency(superannuation, true);
            
            // Update breakdown display (based on actual working time)
            contractPostTaxHourlyEl.textContent = formatCurrency(postTaxHourly);
            contractPostTaxDailyEl.textContent = formatCurrency(postTaxDaily);
            contractPostTaxWeeklyEl.textContent = formatCurrency(postTaxWeekly);
            contractPostTaxFortnightlyEl.textContent = formatCurrency(postTaxWeekly * 2);
            contractPostTaxMonthlyEl.textContent = formatCurrency(postTaxYearly / 12);
            contractPostTaxQuarterlyEl.textContent = formatCurrency(postTaxYearly / 4);

            updateDifference();
        }

        function calculateFullTime() {
            const hoursPerWeek = parseFloat(hoursPerWeekInput.value) || 0;
            const daysPerWeek = parseFloat(daysPerWeekInput.value) || 0;
            const yearlySalary = parseFloat(annualSalaryInput.value) || 0;
            
            const superannuation = yearlySalary * SUPER_RATE;
            const taxOptions = { hasHECS: hecsToggle.checked, hasMLS: mlsToggle.checked };
            const { totalTax, taxLabel } = calculateTax(yearlySalary, taxOptions);
            const postTaxYearly = yearlySalary - totalTax;
            
            fullTimeTakeHomeYearly = postTaxYearly;

            const postTaxWeekly = postTaxYearly / WEEKS_PER_YEAR_DEFAULT;
            const postTaxDaily = daysPerWeek > 0 ? postTaxWeekly / daysPerWeek : 0;
            const postTaxHourly = hoursPerWeek > 0 ? postTaxWeekly / hoursPerWeek : 0;
            
            // Update main display
            fullTimeYearlySalaryEl.textContent = formatCurrency(yearlySalary);
            fullTimeTaxLabel.textContent = taxLabel;
            fullTimeIncomeTaxEl.textContent = formatCurrency(totalTax, true);
            fullTimePostTaxYearlyEl.textContent = formatCurrency(postTaxYearly);
            fullTimeSuperEl.textContent = formatCurrency(superannuation);
            
            // Update breakdown display
            fullTimePostTaxHourlyEl.textContent = formatCurrency(postTaxHourly);
            fullTimePostTaxDailyEl.textContent = formatCurrency(postTaxDaily);
            fullTimePostTaxWeeklyEl.textContent = formatCurrency(postTaxWeekly);
            fullTimePostTaxFortnightlyEl.textContent = formatCurrency(postTaxWeekly * 2);
            fullTimePostTaxMonthlyEl.textContent = formatCurrency(postTaxYearly / 12);
            fullTimePostTaxQuarterlyEl.textContent = formatCurrency(postTaxYearly / 4);
            updateDifference();
        }

        // --- Event Listeners ---
        function recalculateAll() {
            calculateContract();
            calculateFullTime();
        }

        themeToggleBtn.addEventListener('click', () => {
            const currentTheme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            applyTheme(newTheme);
        });

        hourlyRateInput.addEventListener('input', () => {
            lastChangedRate = 'hourly';
            const daily = (parseFloat(hourlyRateInput.value) * (parseFloat(hoursPerWeekInput.value) || 0)) / (parseFloat(daysPerWeekInput.value) || 1);
            dailyRateInput.value = isFinite(daily) && daily > 0 ? daily.toFixed(2) : '';
            recalculateAll();
        });

        dailyRateInput.addEventListener('input', () => {
            lastChangedRate = 'daily';
            const hourly = (parseFloat(dailyRateInput.value) * (parseFloat(daysPerWeekInput.value) || 0)) / (parseFloat(hoursPerWeekInput.value) || 1);
            hourlyRateInput.value = isFinite(hourly) && hourly > 0 ? hourly.toFixed(2) : '';
            recalculateAll();
        });

        annualSalaryInput.addEventListener('input', recalculateAll);
        hoursPerWeekInput.addEventListener('input', recalculateAll);
        daysPerWeekInput.addEventListener('input', recalculateAll);
        unpaidLeaveToggle.addEventListener('change', recalculateAll);
        hecsToggle.addEventListener('change', recalculateAll);
        mlsToggle.addEventListener('change', recalculateAll);
        stateSelect.addEventListener('change', recalculateAll);

        // --- Initial Load ---
        function initialize() {
            const savedTheme = localStorage.getItem('theme') || 'dark'; // Default to dark
            applyTheme(savedTheme);
            superNoteEl.textContent = `The final 'Take-Home Pay' is the key figure for comparing your net income. Calculations use the Australian Superannuation Guarantee rate of ${(SUPER_RATE * 100).toFixed(1)}% and 2024-25 tax rates. Adjustments can be made for unpaid leave, public holidays, HECS/HELP debt, and the Medicare Levy Surcharge.`;
            recalculateAll();
        }

        window.onload = initialize;
    </script>

</body>
</html>
